Autocorrelation_df.ret<-acf(df.ret,plot=FALSE)
Autocorrelation_df.ret
#ARIMA
auto.arima(log(df2))
#ARIMA
auto.arima(df2)
arima.616=Arima(df2,order=c(6,1,6))
print(arima.616)
checkresiduals(arima.022)
arima.022 %>% forecast(h=14) %>% autoplot
#ARIMA
auto.arima(log(df2))
arima.616=Arima(log(df2),order=c(6,1,6))
print(arima.616)
checkresiduals(arima.022)
arima.022 %>% forecast(h=14) %>% autoplot
#stationary test
library(urca)
data2=ts(bitcoin[,2],start=c(2013,4,28))
df2 = window(data2,start = c(2017,1))
df.ret = diff(log(df2))
summary(ur.kpss(df.ret))
adf.test(df.ret)
autoplot(df.ret)
#ARIMA
auto=auto.arima(log(df2))
print(auto)
arima.616=Arima(log(df2),order=c(6,1,6))
print(arima.616)
checkresiduals(arima.022)
arima.022 %>% forecast(h=14) %>% autoplot
#ARIMA
auto.arima(log(df2),trace = TRUE)
arima.616=Arima(log(df2),order=c(6,1,6))
print(arima.616)
checkresiduals(arima.022)
arima.022 %>% forecast(h=14) %>% autoplot
#ARIMA
auto.arima(log(df2),trace = TRUE)
arima.616=Arima(log(df2),order=c(6,1,2))
print(arima.616)
checkresiduals(arima.022)
arima.022 %>% forecast(h=14) %>% autoplot
#ARIMA
auto.arima(log(df2),trace = TRUE)
arima.616=Arima(log(df2),order=c(5,1,2))
print(arima.616)
checkresiduals(arima.022)
arima.022 %>% forecast(h=14) %>% autoplot
#stationary test
library(urca)
data2=ts(bitcoin[,2],start=c(2013,4,28))
df2 = window(data2)
df.ret = diff(log(df2))
summary(ur.kpss(df.ret))
adf.test(df.ret)
autoplot(df.ret)
#stationary test
library(urca)
data2=ts(bitcoin[,2])
df2 = window(data2)
df.ret = diff(log(df2))
summary(ur.kpss(df.ret))
adf.test(df.ret)
autoplot(df.ret)
#stationary test
library(urca)
data2=ts(bitcoin[,2])
df2 = window(data2,start = 1458)
df.ret = diff(log(df2))
summary(ur.kpss(df.ret))
adf.test(df.ret)
autoplot(df.ret)
#stationary test
library(urca)
data2=ts(bitcoin[,2])
df2 = window(data2,start = 1459)
df.ret = diff(log(df2))
summary(ur.kpss(df.ret))
adf.test(df.ret)
autoplot(df.ret)
library(fpp2)
ggAcf(df.ret)
ggPacf(df.ret)
Autocorrelation_df.ret<-acf(df.ret,plot=FALSE)
Autocorrelation_df.ret
#ARIMA
auto.arima(log(df2),trace = TRUE)
arima.616=Arima(log(df2),order=c(5,1,2))
print(arima.616)
checkresiduals(arima.022)
arima.022 %>% forecast(h=14) %>% autoplot
#stationary test
library(urca)
data2=ts(bitcoin[,2])
df2 = window(data2)
df.ret = diff(log(df2))
summary(ur.kpss(df.ret))
adf.test(df.ret)
autoplot(df.ret)
library(fpp2)
ggAcf(df.ret)
ggPacf(df.ret)
Autocorrelation_df.ret<-acf(df.ret,plot=FALSE)
Autocorrelation_df.ret
#ARIMA
auto.arima(log(df2),trace = TRUE)
arima.616=Arima(log(df2),order=c(5,1,2))
print(arima.616)
checkresiduals(arima.022)
arima.022 %>% forecast(h=14) %>% autoplot
#stationary test
library(urca)
data2=ts(bitcoin[,2])
df2 = window(data2)
df.ret = diff(df2)
summary(ur.kpss(df.ret))
adf.test(df.ret)
autoplot(df.ret)
library(fpp2)
ggAcf(df.ret)
ggPacf(df.ret)
Autocorrelation_df.ret<-acf(df.ret,plot=FALSE)
Autocorrelation_df.ret
#ARIMA
auto.arima(log(df2),trace = TRUE)
arima.616=Arima(log(df2),order=c(5,1,2))
print(arima.616)
checkresiduals(arima.022)
arima.022 %>% forecast(h=14) %>% autoplot
#ARIMA
auto.arima(df2,trace = TRUE)
arima.616=Arima(df2,order=c(5,1,2))
print(arima.616)
checkresiduals(arima.022)
arima.022 %>% forecast(h=14) %>% autoplot
#stationary test
library(urca)
data2=ts(bitcoin[,2])
df2 = window(data2)
df.ret = diff(log(df2)
summary(ur.kpss(df.ret))
#stationary test
library(urca)
data2=ts(bitcoin[,2])
df2 = window(data2)
df.ret = diff(log(df2))
summary(ur.kpss(df.ret))
adf.test(df.ret)
autoplot(df.ret)
library(fpp2)
ggAcf(df.ret)
ggPacf(df.ret)
Autocorrelation_df.ret<-acf(df.ret,plot=FALSE)
Autocorrelation_df.ret
#ARIMA
auto.arima(df2,trace = TRUE)
arima.616=Arima(df2,order=c(5,1,2))
print(arima.616)
checkresiduals(arima.022)
arima.022 %>% forecast(h=14) %>% autoplot
#ARIMA
auto.arima(log(df2),trace = TRUE)
arima.616=Arima(log(df2),order=c(5,1,2))
print(arima.616)
checkresiduals(arima.616)
arima.022 %>% forecast(h=14) %>% autoplot
#ARIMA
auto = auto.arima(log(df2),trace = TRUE)
checkresiduals(auto)
arima.616=Arima(log(df2),order=c(5,1,2))
print(arima.616)
checkresiduals(arima.616)
arima.022 %>% forecast(h=14) %>% autoplot
#stationary test
library(urca)
data2=ts(bitcoin[,2])
df2 = window(data2,start = 1458)
df.ret = diff(log(df2))
summary(ur.kpss(df.ret))
adf.test(df.ret)
autoplot(df.ret)
#stationary test
library(urca)
data2=ts(bitcoin[,2])
df2 = window(data2,start = 1459)
df.ret = diff(log(df2))
summary(ur.kpss(df.ret))
adf.test(df.ret)
autoplot(df.ret)
library(fpp2)
ggAcf(df.ret)
ggPacf(df.ret)
Autocorrelation_df.ret<-acf(df.ret,plot=FALSE)
Autocorrelation_df.ret
#ARIMA
auto = auto.arima(log(df2),trace = TRUE)
checkresiduals(auto)
arima.616=Arima(log(df2),order=c(5,1,2))
print(arima.616)
checkresiduals(arima.616)
arima.022 %>% forecast(h=14) %>% autoplot
#stationary test
library(urca)
data2=ts(bitcoin[,2])
df2 = window(data2,start = 1459)
df.ret = diff(log(df))
summary(ur.kpss(df.ret))
adf.test(df.ret)
autoplot(df.ret)
library(fpp2)
ggAcf(df.ret)
ggPacf(df.ret)
Autocorrelation_df.ret<-acf(df.ret,plot=FALSE)
Autocorrelation_df.ret
#ARIMA
auto = auto.arima(log(df2),trace = TRUE)
checkresiduals(auto)
arima.616=Arima(log(df2),order=c(5,1,2))
print(arima.616)
checkresiduals(arima.616)
arima.022 %>% forecast(h=14) %>% autoplot
#ARIMA
auto = auto.arima(log(df),trace = TRUE)
checkresiduals(auto)
arima.616=Arima(log(df),order=c(5,1,2))
print(arima.616)
checkresiduals(arima.616)
arima.022 %>% forecast(h=14) %>% autoplot
#stationary test
library(urca)
data2=ts(bitcoin[,2])
df2 = window(data2,end = 2227)
df.ret = diff(df)
summary(ur.kpss(df.ret))
adf.test(df.ret)
autoplot(df.ret)
#stationary test
library(urca)
data2=ts(bitcoin[,2])
df2 = window(data2,end = 2227)
df.ret = diff(df2)
summary(ur.kpss(df.ret))
adf.test(df.ret)
autoplot(df.ret)
library(fpp2)
ggAcf(df.ret)
ggPacf(df.ret)
Autocorrelation_df.ret<-acf(df.ret,plot=FALSE)
Autocorrelation_df.ret
#ARIMA
auto = auto.arima(log(df),trace = TRUE)
checkresiduals(auto)
arima.616=Arima(log(df),order=c(5,1,2))
print(arima.616)
checkresiduals(arima.616)
arima.022 %>% forecast(h=14) %>% autoplot
#ARIMA
auto = auto.arima(df2,trace = TRUE)
checkresiduals(auto)
arima.616=Arima(log(df2),order=c(5,1,2))
print(arima.616)
checkresiduals(arima.616)
arima.022 %>% forecast(h=14) %>% autoplot
#ARIMA
auto = auto.arima(df2,trace = TRUE)
checkresiduals(auto)
arima.616=Arima(df2,order=c(4,1,4))
print(arima.616)
checkresiduals(arima.616)
arima.022 %>% forecast(h=14) %>% autoplot
#stationary test
library(urca)
data2=ts(bitcoin[,2])
df2 = window(data2,end = 2227)
df.ret = diff(log(df2))
summary(ur.kpss(df.ret))
adf.test(df.ret)
autoplot(df.ret)
library(fpp2)
ggAcf(df.ret)
ggPacf(df.ret)
Autocorrelation_df.ret<-acf(df.ret,plot=FALSE)
Autocorrelation_df.ret
#ARIMA
auto = auto.arima(log(df2),trace = TRUE)
checkresiduals(auto)
arima.616=Arima(log(df2),order=c(4,1,4))
print(arima.616)
checkresiduals(arima.616)
arima.022 %>% forecast(h=14) %>% autoplot
#ARIMA
auto = auto.arima(log(df2),trace = TRUE,max.p = 7, max.q = 7)
checkresiduals(auto)
arima.616=Arima(log(df2),order=c(6,1,4))
print(arima.616)
checkresiduals(arima.616)
arima.022 %>% forecast(h=14) %>% autoplot
#ARIMA
auto = auto.arima(log(df2),trace = TRUE,max.p = 9, max.q = 9, allowdrift = FALSE)
checkresiduals(auto)
arima.616=Arima(log(df2),order=c(6,1,4))
print(arima.616)
checkresiduals(arima.616)
arima.022 %>% forecast(h=14) %>% autoplot
#ARIMA
auto = auto.arima,trace = TRUE,max.p = 9, max.q = 9, allowdrift = FALSE)
#ARIMA
auto = auto.arima(df2,trace = TRUE,max.p = 9, max.q = 9, allowdrift = FALSE)
checkresiduals(auto)
arima.616=Arima(log(df2),order=c(6,1,4))
print(arima.616)
checkresiduals(arima.616)
arima.022 %>% forecast(h=14) %>% autoplot
#ARIMA
auto = auto.arima(df2,trace = TRUE,max.p = 9, max.q = 9, allowdrift = FALSE)
checkresiduals(auto)
arima.616=Arima(log(df2),order=c(4,1,4))
print(arima.616)
checkresiduals(arima.616)
arima.022 %>% forecast(h=14) %>% autoplot
#ARIMA
auto = auto.arima(df2,trace = TRUE,max.p = 9, max.q = 9, allowdrift = FALSE)
checkresiduals(auto)
arima.616=Arima(df2,order=c(4,1,4))
print(arima.616)
checkresiduals(arima.616)
arima.022 %>% forecast(h=14) %>% autoplot
#stationary test
library(urca)
data2=ts(bitcoin[,2])
df2 = window(data2,end = 2227)
df.ret = diff(df2)
summary(ur.kpss(df.ret))
adf.test(df.ret)
autoplot(df.ret)
library(fpp2)
ggAcf(df.ret)
ggPacf(df.ret)
Autocorrelation_df.ret<-acf(df.ret,plot=FALSE)
Autocorrelation_df.ret
#ARIMA
auto = auto.arima(df2,trace = TRUE,max.p = 9, max.q = 9, allowdrift = FALSE, start.p = 3, start.q = 3)
checkresiduals(auto)
arima.616=Arima(df2,order=c(4,1,4))
print(arima.616)
checkresiduals(arima.616)
arima.022 %>% forecast(h=14) %>% autoplot
#ARIMA
auto = auto.arima(df2,trace = TRUE,max.p = 9, max.q = 9, allowdrift = FALSE, start.p = 3, start.q = 4)
checkresiduals(auto)
arima.616=Arima(df2,order=c(4,1,4))
print(arima.616)
checkresiduals(arima.616)
arima.022 %>% forecast(h=14) %>% autoplot
#ARIMA
auto = auto.arima(df2,trace = TRUE,max.p = 9, max.q = 9, allowdrift = FALSE, start.p = 4, start.q = 4)
checkresiduals(auto)
arima.616=Arima(df2,order=c(4,1,4))
print(arima.616)
checkresiduals(arima.616)
arima.022 %>% forecast(h=14) %>% autoplot
knitr::opts_chunk$set(echo = TRUE, cache=TRUE)
library(fpp2)
library(ggplot2)
library(tseries)
options(width=45)
os.getwd()
data<-read.csv("final_data.csv",as.is=TRUE)
data<-read.csv("final_data.csv",as.is=TRUE)
data<-ts(data)
View(data)
data<-read.csv("final_data.csv",as.is=TRUE)
View(data)
data<-read.csv("final_data.csv",as.is=TRUE)
data<-data['date',"price",'ontario_demand']
data<-read.csv("final_data.csv",as.is=TRUE)
data<-data[['date',"price",'ontario_demand']]
data<-read.csv("final_data.csv",as.is=TRUE)
data<-data[,2]
data = window(data,start = c(2017,1))
data<-read.csv("final_data.csv",as.is=TRUE)
data<-data[,2]
data = window(data,start = c(2017,1))
data
knitr::opts_chunk$set(echo = TRUE, cache=TRUE)
library(fpp2)
library(ggplot2)
library(tseries)
library(xts)
library(lubridate)
options(width=45)
raw = read.csv("final_data.csv")
date_time = as_datetime(raw[,1])
price = xts( x = raw[,"price"], order.by = date_time, frequency = 24)
demand = xts( x = raw[,"ontario_demand"], order.by = date_time, frequency = 24)
demand_train = demand["2020/2021"]; demand_test = demand["2022"]
price_train = price["2020/2021"]; price_test = price["2022"]
out =  ets( price_train )
fit = ets( c(price_train, price_test), model = out )
pred = tail( fitted(fit ), n = length(price_test) )
out =  ets( price_train )
fit = ets( c(price_train, price_test), model = out )
pred = tail( fitted(fit ), n = length(price_test) )
pred
price_train
out =  ets( price_train )
fit = ets( c(price_train, price_test), model = out )
pred = tail( fitted(fit ), n = length(price_test) )
plot(pred)
autoplot(price_test) +
autolayer(pred, PI=FALSE, series="Prediction Price")
plot(price_test) +
lines(pred, PI=FALSE, series="Prediction Price")
plot(price_test) +
lines(pred)
plot(price_test) + lines(pred)
price_test
plot(price_test)
plot(price_test)
plot(pred)
out =  ets( price_train )
fit = ets( c(price_train, price_test), model = out )
pred = tail( fitted(fit ), n = length(price_test) )
pred = xts( x = pred, order.by = date_time, frequency = 24)
out =  ets( price_train )
fit = ets( c(price_train, price_test), model = out )
pred = tail( fitted(fit ), n = length(price_test) )
pred = xts( x = pred,frequency = 24)
pred
price_train
plot(price_test)
plot(pred)
cbind(price_test,pred)
result= cbind(price_test,pred)
autoplot(result$price_test) +
autolayer(result$pred)
result= cbind(price_test,pred)
autoplot(result$price_test)
result= cbind(price_test,pred)
autoplot(result$price_test)
autoplot(result$pred)
result= cbind(price_test,pred)
autoplot(result$price_test)+lines(result$pred)
result= cbind(price_test,pred)
autoplot(result)
result= cbind(price_test,pred)
autoplot(result)
diff = result$price_test-result$pred
result= cbind(price_test,pred)
autoplot(result)
diff = result$price_test-result$pred
MSE = mean(diff^2)
result= cbind(price_test,pred)
autoplot(result)
diff = result$price_test-result$pred
MSE = mean(diff^2)
MSE
result= cbind(price_test,pred)
autoplot(result)
diff = result$price_test-result$pred
MSE = mean(diff^2)
MSE
diff
result= cbind(price_test,pred)
autoplot(result)
diff = result$price_test-result$pred
MSE = mean(diff^2)
MSE
result= cbind(price_test,pred)
autoplot(result)
diff = result$price_test-result$pred
MSE = mean(diff^2)
MSE
MAE=mean(diff)
MAE
result= cbind(price_test,pred)
autoplot(result)
diff = result$price_test-result$pred
MSE = mean(diff^2)
MSE
MAE=mean(abs(diff))
MAE
result= cbind(price_test,pred)
autoplot(result)
diff = result$price_test-result$pred
MSE = mean(diff^2)
MSE
MAE=mean(abs(diff)^2)
MAE
result= cbind(price_test,pred)
autoplot(result)
diff = result$price_test-result$pred
MSE = mean(diff^2)
MSE
MAE=mean(abs(diff))
MAE
load('final_daily.csv')
setwd("~/Documents/GitHub/STAD95_W23/Data")
load('final_daily.csv')
read.csv('final_daily.csv')
df = read.csv('final_daily.csv')
View(df)
ccf(df[,1:2])
ccf(df[,1],df[,2])
ccf(df[,2],df[,3])
ccf(df[,2],df[,-1])
ccf(df[,2],df[,23])
ccf(df[,2],df[,3],max.lag=200)
ccf(df[,2],df[,3],lag.max =NULL)
ccf(df[,2],df[,3],lag.max =200)
ccf(df[,2],df[,3],lag.max =1000)
